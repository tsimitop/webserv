<!DOCTYPE html>
<html>
<body>

<h1>The simplest index ever</h1>
<p>Is this a simple index or what?</p>

<input type="file" id="myFile">
<button onclick="uploadFile()">Upload</button>

<br><br>

<input type="text" id="filenameToDelete" placeholder="Enter filename to delete">
<button onclick="deleteFile()">Delete</button>

<br><br>

<button onclick="tryCGI()">Try CGI</button>

<script>
	function uploadFile() {
		const fileInput = document.getElementById("myFile");
		const file = fileInput.files[0];

		if (!file) {
			alert("Please select a file");
			return;
		}

		const filename = file.name;

		fetch('/uploads', {
			method: "POST",
			headers: {
				"Content-Type": "application/octet-stream",
				"Content-Disposition": 'attachment; filename="' + filename + '"',
			},
			body: file // Send the raw file
		}).then(response => console.log("Upload complete"))
		  .catch(error => console.error("Error:", error));
	}
</script>

<script>
	function deleteFile() {
		const filenameInput = document.getElementById("filenameToDelete");
		
		if (!filenameInput || !filenameInput.value) {
			alert("Please enter a filename to delete.");
			return;
		}

		const filename = filenameInput.value;

		fetch('/uploads/' + encodeURIComponent(filename), {
			method: "DELETE"
		})
		.then(response => {
			if(response.ok) {
				console.log ("Deleted: " + filename);
				// alert("File deleted successfully: " + filename);
			} else {
				console.error("Failed to delete: " + filename);
				// alert("Failed to delete file: " + filename);
			}
		})
		.catch(error => console.error("Error: ", error));
	}
</script>

<script>
	function tryCGI() {
	  fetch('../cgi/hello.py')
		.then(response => {
		  if (!response.ok) throw new Error("Network response was not ok");
		  return response.text();
		})
		.then(data => {
		  console.log("CGI successfully executed");
		//   console.log("Response:", data);
		//   alert(data);
		})
		.catch(error => {
		  console.error("Error:", error);
		});
	}
  </script>

</body>
</html>



<!-- <form action="/uploads/" method="post" enctype="multipart/form-data">
	<label for="fileUpload">Choose a file:</label>
	<input type="file" id="fileUpload" name="file" required>
	<input type="submit" value="Upload File">
</form> -->